Chi-square test of association
The following example demonstrates how to conduct a Chi-square test of association using Rcmdr. 
This example uses the Breast Cancer.csv data file to look at an association between breast cancer and the age at which a mother first gives birth. 
Ensure you re-order the Age_Band variable appropriately.

Rcmdr

Statistics -->Contingency tables-->Two-way tables..  


Select Status (Cases vs. Controls) for the row variable and Age_Band as the column variable. Select the option to display row percentages as we are interested in the 
how the conditional probability of a mother's age at their first birth differs between cases (breast cancer) and controls. Select Chi-square test of independence 
to perform a hypothesis test on the observed data. The results will be reported across two major parts in the output window


The first part creates a contingency table of the counts. The second table shows the conditional percentages (row percentages) and total counts 
in each row. For example, we can see that 43.3% (4432/10245) of control mothers gave birth to their first child aged between 20-24 years compared to only 37.5% (1206/3220) 
of cases.

The second part reports the results of the Chi-square test of association. As we can see, the results of the test show a statistically significant association between 
breast cancer and the age at which a mother first gives birth, X-square (df = 4) = 130.34, p < .001. You should create a clustered bar chart of the conditional percentages to 
help explore the nature of the significant association.

Here is the R code...

table <- xtabs(~Status+Age_Band, data=Dataset) ##Create table
barplot(prop.table(table,1)*100,xlab="Age Band", ylab="Percentages",legend = rownames(table),
    beside=TRUE,args.legend = list(x="topright",title="Breast Cancer",bty="n"))
Summarised Data

If the results of the study were already summarised in a contingency table, we could use Rcmdr's built in features to enter the data directly instead of loading a data file.

Statistics-->Contingency tables-->Enter and analyse two-way table...


R

From a Dataset
table <- xtabs(~Status+Age_Band, data=Dataset) ##Create table
table ##Report table
rowPercents(table) # Report Row Percentages
test <- chisq.test(table, correct=FALSE) ##Conduct test and save as an object
test #Report test results

Using Summarised Data
table <- matrix(c(320,1206,1011,463,220,1422,4432,2893,1092,406), 2, 5, byrow=TRUE) ##Create table
rownames(table) <- c('Cases', 'Control') ##Add row labels
colnames(table) <- c('<20', '20-24', '25-29', '30-34', '>=35') ##Add column labels
table  # Report counts
rowPercents(table) # Report row percentages
test <- chisq.test(table, correct=FALSE) ##Conduct test and save as an object
test #Report test results

#scatter plot
> scatterplot(VO2_Max~OUES_3, reg.line=lm, smooth=FALSE, spread=FALSE, 
   id.method='mahal', id.n = 2, boxplots=FALSE, span=0.5, data=Dataset)

Correlation test
> with(Dataset, cor.test(OUES_3, VO2_Max, alternative="two.sided", 
   method="pearson"))

ANOVA table
> RegModel.6 <- lm(VO2_Max~OUES_3, data=Dataset)
> summary(RegModel.6)
> anova(RegModel.6)

Descriptive Statistics? > ?
Categorical Summaries
This sub-topic covers descriptive statistics for ordinal and categorical data.

Rcmdr

Frequencies

Statistics --> Summaries --> Frequency distributions

Cross-tabulation (Two-way table)

Statistics --> Contingency tables - Two-way table

Select which variables need to appear as either row or column categories. Select which percentages you want displayed. You can also specify
 if you want contingency table tests to be conducted (e.g. Chi-square test of association). Select OK to create the table.

The two-way table results are reported in the Output Window. The counts and percentages are separated into two tables. Bar Charts are the perfect way to
 depict categorical data.

R

Frequencies

table <- table(sgdata$Actual) # Create table object
table # Output table object
round(100*table/sum(table), 2)  # Get percentages
Cross-tabulation (Two-way table)

table <- xtabs(~Expected+Actual, data=sgdata) #create two-way table object
table # Output table object
colPercents(table) # Output column percentages
rowPercents(table) # Output row percentages

Basic Statistical Analysis? > ?
Chi-square Goodness of Fit Test
The Chi-square goodness of fit test is used to test if a distribution of observed data differs significantly from a known population distribution. For example, 
the distribution of blood types in Australia is reported by the Australian Red Cross Blood Services (see Figure below). Let's assume that a researcher takes a 
random sample of 1054 people from a city in Australia and tests their blood types. The researcher wants to know if there is any statistical evidence that the distribution 
of blood types in the city is different to the Australia-wide distribution.

The sample's distribution of blood type are summarised as follows:

 O+	 O-	 A+	 A-	 B+	 B-	 AB+	 AB-	 Total
 431	 97	 313	 71	 86	 21	 23	 13	 1054
Unfortunately, Rcmdr does not have an easy way to run the Chi-square goodness of fit test. We will have to work directly with the R code in the script window.

First we set-up the table of population probabilities.

table<-matrix(c(.4,.09,.31,.07,.08,.02,.02,.01),8,1,byrow=TRUE)
rownames(table)<-c("O+","O-","A+","A-","B+","B-","AB+","AB-")
colnames(table)<-c("Probs")
Next, we input the sample results.

sample<-c(431,97,313,71,86,21,23,12)
Then we run a Chi-square test.

chisq.test(sample, p=table[,1])
The code table[,1] tells R to extract the expected probabilities from the 1st column of the table object. The results will be reported in the output window.

The results of the Chi-square goodness of fit test are not statistically significant, Chi-square = 1.35, p = 0.987. Therefore, there was no statistically significant evidence that the 
distribution of blood type in the city differed from the Australian-wide distribution.


The following example of conducting one-way ANOVA using Rcdmr makes use of the Blood Pressure Experiment.csv dataset. You can follow this example by downloading this dataset which has been attached at the bottom of this page. Once you have loaded the dataset ensure you reorder the Condition factor so that 1 = Placebo, 2 = Drug A, 3 = Drug B and 4 = Drug C.
Rcdmr

One-way Analysis of Variance (ANOVA) is used to test for statistically significant differences between population means when you have more than two groups. 
One-way ANOVA assumes that the data is normally distributed in the population and that the populations being compared have equal variance. The assumptions of
 normality and homogeneity of variance were tested and confirmed prior to running the one-way ANOVA in this example (the R code for doing so has been included 
in the R section below). We should also look at the difference in the distributions of the samples visually to get a sense of where significant difference may be likely to lie. For 
example, the boxplot below shows that the drug groups all score lower than the placebo condition and that Drug C has the lowest median score

Statistics--> Means --> One-way ANOVA...

You can enter a custom name for the ANOVA model. Saving the model as an object allows you to recall and conduct follow-up testing at a later time. 
Groups refers to the factor. In one-way ANOVA,we only have one factor. The response variable refers to the outcome variable. 
Ensure you select the option for Pairwise Comparisons of means. The Rcmdr reports the Tukey's multiple comparisons procedure by default. 
This procedures protects against inflated Type I Error associated with multiple comparisons. Click OK to run the test.

The default output from Rcdmr is quite extensive, but can be broken up into four main tables. The first table reported is the results of the ANOVA. As you can see above,
 the one-way ANOVA is statistically significant, F(3,76) = 18.84, p < .001. We can calculate the eta-squared effect size for the model by dividing the Condition sum 
of squares (Sum Sq) by the total sum of squares, 1616/(1616+2172) = .427. Therefore, 42.7% of the variability in blood pressure was explained by the Condition factor. 
The second table simply reports the descriptive statistics. As the results of the one-way ANOVA were statistically significant, we need to follow-up with 
multiple comparisons to locate the source of this significant result.

The third table reports the results of the pairwise multiple comparisons. As you can see, these comparisons have been adjusted according to a Tukey's procedure. 
All possible multiple comparisons are listed under Linear Hypotheses. You can calculate the number of all possible pairwise comparions using the 
nChoosek function in R. Type choose(4, 2), where 4 = the number of conditions, and you can calculate the number of pairwise comparisons that that will be tested. 
In this situation  choose(4, 2) = 6. The pairwise multiple comparisons determine if there is a statistically significant difference between means for each possible pair of 
groups after controlling for Inflated Type I Error. For example, according to the Tukey's multiple comparisons procedure, there was a statistically significant 
difference between Drug A and Placebo, p < .001, Drug B and Placebo, p < .001, and Drug C and Placebo, p < .001. 

The fourth table reports the Tukey's adjusted 95% CI of the difference between means for each multiple comparison. If these confidence intervals do 
not capture 0, the difference between the means is statistically significant. Rcmdr uses this information to report a very useful plot of the multiple 
comparisons (see below). As you can see, all three drugs are significantly different to the placebo. However, all multiple comparisons between the 
drugs themselves are not statistically significant.

R

Testing Normality

Placebo <- subset(Dataset, subset=Condition=='Placebo')
shapiro.test(Placebo$SBP)
DrugA <- subset(Dataset, subset=Condition=='Drug A')
shapiro.test(DrugA$SBP)
DrugB <- subset(Dataset, subset=Condition=='Drug B')
shapiro.test(DrugB$SBP)
DrugC <- subset(Dataset, subset=Condition=='Drug C')
shapiro.test(DrugC$SBP)
Testing Homogeneity of Variance

leveneTest(Dataset$SBP, Dataset$Condition, center=mean)
One-way ANOVA
anova<- aov(SBP ~ Condition, data=Dataset) #Run one-way ANOVA
summary(anova) #Report summary
numSummary(Dataset$SBP , groups=Dataset$Condition, statistics=c("mean", "sd")) #Report descriptives
Pairwise Multiple Comparisons

library(multcomp, pos=4) #Load multicomp package
library(abind, pos=4) #Load abind package
pairs <- glht(anova, linfct = mcp(Condition = "Tukey")) #Calculate pairwise comparisons
summary(pairs) # Summary of pairwise tests
confint(pairs) # Confidence intervals
cld(pairs) # Groups with difference subscripts are significantly different
old.oma <- par(oma=c(0,5,0,0)) #Adjust Graphic device to fit pairwise CIs plot correctly
plot(confint(pairs)) # Plot pairwise CIs
par(old.oma) #Restore graphic device defaults
remove(pairs) #Remove pairs objec

